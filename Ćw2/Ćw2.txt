drop table "REGIONS" CASCADE CONSTRAINTS;
drop table "COUNTRIES" CASCADE CONSTRAINTS;
drop table "DEPARTMENTS" CASCADE CONSTRAINTS;
drop table "JOBS" CASCADE CONSTRAINTS;
drop table "LOCATIONS" CASCADE CONSTRAINTS;
drop table "EMPLOYEES" CASCADE CONSTRAINTS;

CREATE TABLE COUNTRIES AS (SELECT * FROM HR.COUNTRIES);
CREATE TABLE DEPARTMENTS AS (SELECT * FROM HR.DEPARTMENTS);
CREATE TABLE EMPLOYEES AS (SELECT * FROM HR.EMPLOYEES);
CREATE TABLE JOB_GRADES AS (SELECT * FROM HR.JOB_GRADES);
CREATE TABLE JOB_HISTORY AS (SELECT * FROM HR.JOB_HISTORY);
CREATE TABLE JOBS AS (SELECT * FROM HR.JOBS);
CREATE TABLE LOCATIONS AS (SELECT * FROM HR.LOCATIONS);
CREATE TABLE REGIONS AS (SELECT * FROM HR.REGIONS);

1. CREATE VIEW JEDEN AS SELECT concat(concat(LAST_NAME, '+'), SALARY) AS  "WYNAGRODZENIE" FROM EMPLOYEES WHERE (SALARY<7000 and SALARY>2000 and DEPARTMENT_ID = 20 or DEPARTMENT_ID=50) order by LAST_NAME;

2. CREATE VIEW DWA AS SELECT LAST_NAME, MANAGER_ID, HIRE_DATE FROM EMPLOYEES WHERE extract(YEAR from HIRE_DATE) = '2005' order by HIRE_DATE;

3. CREATE VIEW TRZY AS SELECT concat(FIRST_NAME, LAST_NAME) AS "NAZWISKA Z E", SALARY, PHONE_NUMBER FROM EMPLOYEES WHERE LAST_NAME like '__e%' and FIRST_NAME like '%' ORDER BY LAST_NAME asc, FIRST_NAME asc, PHONE_NUMBER desc;

4. CREATE VIEW CZTERY AS SELECT FIRST_NAME, LAST_NAME, round(months_between(current_date, HIRE_DATE)) "LICZBA_MIESIECY",
    case 
    when round(months_between(current_date, HIRE_DATE)) <= 149 THEN SALARY * 0.1
    when round(months_between(current_date, HIRE_DATE)) between 150 and 200 THEN SALARY * 0.2
    when round(months_between(current_date, HIRE_DATE)) >= 200 THEN SALARY * 0.3
    else 0 end as WYSOKOSC_DODATKU
    from EMPLOYEES
    order by "LICZBA_MIESIECY";
